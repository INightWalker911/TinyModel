# TinyML PCB Defect Detector (ESP32-CAM)

Простой проект по запуску нейросети на микроконтроллере **ESP32-CAM**. Система анализирует видеопоток в реальном времени и находит дефекты на печатных платах (PCB).

Вся обработка происходит на плате (on-device), без отправки данных на сервер.

### Что умеет
Классифицирует 6 типов дефектов производства плат:
1.  **Missing Hole** (Отсутствует отверстие)
2.  **Mouse Bite** (Скол с краю)
3.  **Open Circuit** (Разрыв дорожки)
4.  **Short** (Короткое замыкание/спайка)
5.  **Spur** (Лишний выступ меди)
6.  **Spurious Copper** (Лишняя медь/пятна)

Если дефект найден, на видео рисуется цветная рамка, а в Serial-порт выводится название класса и уверенность модели (Confidence).
Ссылка на датасет: https://www.kaggle.com/datasets/akhatova/pcb-defects

### Железо и Софт
*   **Плата:** AI-Thinker ESP32-CAM.
*   **Камера:** OV2640 (идет в комплекте).
*   **Среда:** Arduino IDE + Google Colab (для обучения).
*   **Фреймворк:** TensorFlow Lite for Microcontrollers.

### Структура репозитория
*   `training.ipynb` — Jupyter Notebook для Google Colab. Там происходит скачивание датасета, обучение модели и конвертация в формат `.tflite` / C-byte array.
*   `PCB_Detector.ino` — Основной скетч для ESP32. Поднимает веб-сервер и крутит нейросеть.
*   `model_data.h` — Мозги нейросети. Этот файл генерируется в конце обучения в Colab.

### Как запустить

1.  **Обучение:**
    *   Открыть `training.ipynb` в Google Colab.
    *   Запустить все ячейки.
    *   Скачать сгенерированный файл `model_data.h`.

2.  **Прошивка:**
    *   Положить `model_data.h` в одну папку со скетчем `PCB_Detector.ino`.
    *   В скетче указать свои настройки Wi-Fi (`ssid`, `password`).
    *   Настроить Arduino IDE:
        *   Board: **ESP32 Dev Module** (или AI Thinker ESP32-CAM).
        *   Partition Scheme: **Huge APP** (важно, иначе модель не влезет).
    *   Загрузить скетч в плату (через USB-TTL конвертер).

3.  **Тест:**
    *   Открыть Монитор порта (115200 baud).
    *   Скопировать IP-адрес (например, `http://192.168.1.50/stream`).
    *   Открыть в браузере и навести камеру на плату.

